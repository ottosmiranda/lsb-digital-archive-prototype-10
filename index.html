
<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Biblioteca Digital LSB - Link School of Business</title>
    <meta name="description" content="Acesso gratuito a livros, artigos, v√≠deos e podcasts educacionais da Link School of Business" />
    <meta name="author" content="Link School of Business" />

    <!-- Placeholder favicon - Simple "L" for LSB -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' fill='%23003366'/><text x='8' y='24' font-family='Arial' font-size='20' font-weight='bold' fill='white'>L</text></svg>" type="image/svg+xml">

    <meta property="og:title" content="Biblioteca Digital LSB" />
    <meta property="og:description" content="Sua fonte aberta de conhecimento na LSB" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lsb_oficial" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <!-- CSP for VLibras -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://vlibras.gov.br; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://vlibras.gov.br; font-src 'self' https://fonts.gstatic.com https://vlibras.gov.br; connect-src 'self' https://*.supabase.co https://link-business-school.onrender.com https://vlibras.gov.br https://acessos.vlibras.gov.br; img-src 'self' data: https: blob:; media-src 'self' https: blob:; object-src 'none'; base-uri 'self'; worker-src 'self' blob:;">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  </head>

  <body>
    <div id="root"></div>
    
    <!-- VLibras Widget - Official Implementation -->
    <div vw class="enabled">
      <div vw-access-button class="active"></div>
      <div vw-plugin-wrapper>
        <div class="vw-plugin-top-wrapper"></div>
      </div>
    </div>
    
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- VLibras Official Implementation -->
    <script>
      (function() {
        console.log('üîß VLibras - Starting official implementation...');
        
        // Check if VLibras is available
        function checkVLibrasAvailability() {
          return fetch('https://vlibras.gov.br/app/vlibras-plugin.js', { 
            method: 'HEAD',
            mode: 'no-cors'
          }).then(() => true).catch(() => false);
        }
        
        function initVLibras() {
          console.log('üì° Loading VLibras from official source...');
          
          const script = document.createElement('script');
          script.src = 'https://vlibras.gov.br/app/vlibras-plugin.js';
          script.defer = true;
          
          script.onload = function() {
            console.log('‚úÖ VLibras script loaded successfully');
            
            try {
              // Give VLibras time to initialize
              setTimeout(() => {
                if (typeof window.VLibras !== 'undefined') {
                  new window.VLibras.Widget('https://vlibras.gov.br/app');
                  console.log('üöÄ VLibras widget initialized successfully');
                } else {
                  console.warn('‚ö†Ô∏è VLibras object not available after script load');
                  showFallbackAccessibility();
                }
              }, 1000);
              
            } catch (error) {
              console.error('‚ùå VLibras initialization failed:', error);
              showFallbackAccessibility();
            }
          };
          
          script.onerror = function(error) {
            console.error('‚ùå Failed to load VLibras script:', error);
            showFallbackAccessibility();
          };
          
          document.head.appendChild(script);
        }
        
        function showFallbackAccessibility() {
          console.log('üîÑ Showing fallback accessibility option...');
          
          // Hide VLibras elements if they exist
          const vwElements = document.querySelectorAll('[vw]');
          vwElements.forEach(el => el.style.display = 'none');
          
          // Create simple accessibility notice
          const fallbackDiv = document.createElement('div');
          fallbackDiv.innerHTML = `
            <div style="position: fixed; bottom: 20px; right: 20px; background: #003366; color: white; padding: 10px; border-radius: 8px; font-size: 12px; z-index: 9999; max-width: 250px;">
              <strong>Acessibilidade:</strong><br>
              Para recursos de acessibilidade, visite: 
              <a href="https://vlibras.gov.br" target="_blank" style="color: #87CEEB; text-decoration: underline;">
                VLibras
              </a>
              <button onclick="this.parentElement.parentElement.remove()" style="float: right; background: none; border: none; color: white; cursor: pointer; font-size: 14px;">√ó</button>
            </div>
          `;
          
          document.body.appendChild(fallbackDiv);
          
          // Auto-hide after 10 seconds
          setTimeout(() => {
            if (fallbackDiv.parentElement) {
              fallbackDiv.remove();
            }
          }, 10000);
        }
        
        // Check availability and initialize
        checkVLibrasAvailability()
          .then(available => {
            if (available) {
              console.log('üéØ VLibras service is available, initializing...');
              initVLibras();
            } else {
              console.warn('‚ö†Ô∏è VLibras service not available, showing fallback...');
              showFallbackAccessibility();
            }
          })
          .catch(error => {
            console.error('‚ùå Error checking VLibras availability:', error);
            showFallbackAccessibility();
          });
        
        // Export for debugging
        window.vlibrasDiagnostics = {
          reinitialize: initVLibras,
          showFallback: showFallbackAccessibility,
          checkAvailability: checkVLibrasAvailability
        };
        
      })();
    </script>
  </body>
</html>
